---
title: '统计学入门'
date: 2025-09-03
permalink: /posts/2025/09/2025-09-03-统计学入门/
excerpt: "微积分视角的统计学入门。"
tags:
  - Math
  - Stat
---

笔者没有学过数学分析等知识，所以全文的内容应该有很大一部分是不严格的。当成感性理解看吧。

# 统计学的基本框架

- 描述：通过一些参数来描述已有数据的特征。
- 推断：基于已有的数据，推断总体的规律，并作出预测。

# 概率分布

对于一个连续型随机变量 $X$，若有一函数 $f$ 恒非负，且满足对于任意区间 $[l,r]$，$P(X \in [l,r]) = \int_l^r f(x) dx$，则称 $f$ 是 $X$ 的**概率密度函数（Probability density function, PDF）**。

所有事件的概率和为 $1$，因此 PDF 满足以下性质：

$$\int_{-\infty}^\infty f(x) dx = 1$$

**概率分布**描述不同事件发生的可能性，每一种概率分布有自己的 PDF。若我们有一个分布 $D$，我们想说 $X$ 服从这个分布，可以用这个符号：

$$X \sim D$$

对于常见的分布，我们还有特别的记号，见后文的常见概率分布。

除了**连续概率分布**，还有**离散概率分布**。这就更简单了，把所有 $\int$ 改成 $\sum$ 就行咯。对于离散分布我们一般不说 PDF，而是叫做**概率质量函数（Probability mass function, PMF）**，但是意思是一样的。

## 期望 Expectation

$$\mathbb E[X] = \int_{-\infty}^\infty x f(x) dx$$

直觉建立：和物理学中的**重心**是相似的。

$$x_{\text{CM}} = \frac {\int x \rho(x) dx} {\int \rho(x) dx}$$

分母上的总质量在概率的语境下是总概率，永远是 $1$。

## 方差 Variance

$$\text{var}(X) = \mathbb E[(X - \mathbb E[X])^2]$$

> $\text{var}(X)$ 还会记作 $\sigma^2$。$\sigma$ 是**标准差（standard deviation）**，定义为方差的非负平方根 $\sqrt{\text{var}(X)}$。还有一种写法是 $\sigma = \text{SD}(X)$。

直觉建立：

$$\text{var}(X) = \int (x - \mathbb E[X])^2 f(x) dx$$

和物理学中的**转动惯量**是相似的，这里特指轴过重心时的转动惯量。转动惯量和方差都描述了分布的分散程度，一个是物理的密度，另一个是概率的密度。

根据这样的直觉，我们可以发现**平行轴定理**的类比：

$$\mathbb E[(X - a)^2] = \text{var}(X) + (\mathbb E[X] - a)^2$$

令 $a=0$ 我们可以得到一个方差的常用公式：

$$\text{var}(X) = \mathbb E[X^2] - \mathbb E[X]^2$$

### 协方差

<!-- TODO: 转动惯量张量好像也有类似的类比。-->

$$\text{Cov}(X,Y) = \mathbb E[(X - \mathbb E[X]) (Y - \mathbb E[Y])]$$

## 期望和方差的常见性质

### 期望

对于两个随机变量 $X,Y$（**不要求独立**），有**期望的线性性**：

$$\mathbb E[aX + bY] = a \mathbb E[X] + b \mathbb E[Y]$$

---

对于两个**独立**的随机变量 $X,Y$，有：

$$\mathbb E[XY] = \mathbb E[X] \mathbb E[Y]$$

---

### 方差

平移一个常数 $C$：

$$\text{var}(X + C) = \text{var}(X)$$

---

数乘：

$$\text{var}(aX) = a^2 \text{var}(X)$$

---

对于**独立**的随机变量 $X,Y$，有：

$$\text{var}(X+Y) = \text{var}(X) + \text{var}(Y)$$

证明：

$$\begin{aligned}
    \text{var}(X + Y) &= \mathbb E[(X+Y)^2] - \mathbb E[X+Y]^2 \\
    &= \mathbb E[X^2] + 2 \mathbb E[XY] + \mathbb E[Y^2] - \mathbb E[X]^2 - 2 \mathbb E[X] \mathbb E[Y] - \mathbb E[Y]^2 \\
    &= \text{var}(X) + \text{var}(Y) + 2 (\mathbb E[XY] - \mathbb E[X] \mathbb E[Y]) \\
    &= \text{var}(X) + \text{var}(Y) \\
\end{aligned}$$

### 协方差

TODO:

----

## 常见的概率分布

见另一篇文章 TODO:。实践性较强，与本文的理论关系不大。

## References

- [概率论学习笔记（一）](https://zhuanlan.zhihu.com/p/42859784)
- [概率论学习笔记（二）](https://zhuanlan.zhihu.com/p/42950143)
- [概率论学习笔记（四）](https://zhuanlan.zhihu.com/p/45720457)

# 总体和样本

刚才说到的 $\mu,\sigma$ 这些量，都是隐藏在现实世界背后的真正规律，是**总体**的量。在实际生活中，我们只能采集有限的样本，来试图逼近这些真实的总体的量。通过样本进行的估算，得到的是**样本**的量。我们使用记号 `\hat` 来说明一个总体量是被估算出来的，比如 $\hat \mu, \hat \sigma$。

$\mathbb E[\bar{\mu}] = \mu$，$\mathbb E[\hat{\sigma}^2] = \sigma^2$。这种通过期望来估计的方式称为**无偏估计**。

符号滥用：这一部分会混用 $x$ 和 $X$。

## 均值

总体均值记作 $\mu$，**样本均值**记作 $\bar{x}$（$\hat \mu$）。

接下来我们推导 $\bar{x}$ 的表达式。令 $X_i$ 为 $X$ 的第 $i$ 次实现值。

$$\begin{aligned}
    & \mu = \mathbb E[X] \\
    =& \frac 1 n \sum\limits_{i=1}^n \mathbb E[X_i] \\
    =& \mathbb E \left[ \frac 1 n \sum\limits_{i=1}^n X_i \right] \\
\end{aligned}$$

$$\boxed{\hat \mu = \bar X = \frac 1 n \sum\limits_{i=1}^n X_i}$$

## 方差

总体方差记作 $\sigma^2$，**（无偏）样本方差**记作 $s^2$（$\hat \sigma^2$）。

$\sigma$ 是用 $\mu$ 计算的，$\hat \sigma$ 得要转成用 $\bar{x}$ 计算的形式。

$$\begin{aligned}
    & \sigma^2 \\
    =& \mathbb E \left[ \sum (x - \mu)^2 \right] \\
    =& \mathbb E \left[ \frac 1 n \sum (X_i - \mu)^2 \right] \\
    =& \frac 1 n \mathbb E \left[ \sum (X_i - \bar{X} + \bar{X} - \mu)^2 \right] \\
    =& \frac 1 n \mathbb E \left[ \sum (X_i - \bar{X})^2 + 2 (\bar{X} - \mu) \sum (X_i - \bar{X}) + \sum (\bar{X} - \mu)^2 \right] \\
    =& \frac 1 n \mathbb E \left[ \sum (X_i - \bar{X})^2 + n (\bar{X} - \mu)^2 \right] \\
    =& \frac 1 n \mathbb E \left[ \sum (X_i - \bar{X})^2 \right] + \frac 1 n \times n \times \mathbb E[(\bar{X} - \mathbb E[\bar{X}])^2] & ^* \mu = \mathbb E[X] \\
    =& \frac 1 n \mathbb E \left[ \sum (X_i - \bar{X})^2 \right] + \frac 1 n \times n \times \text{var}(\bar{X}) \\
    =& \frac 1 n \mathbb E \left[ \sum (X_i - \bar{X})^2 \right] + \frac {\sigma^2} n \\
\end{aligned}$$

因此 $\frac 1 n \mathbb E \left[ \sum (X_i - \bar{X})^2 \right] = \frac {n-1} n \sigma^2$，即

$$\sigma^2 = \mathbb E \left[ \frac 1 {n-1} \sum (X_i - \bar{X})^2 \right]$$

$$\boxed{\hat{\sigma}^2 = s^2 = \frac 1 {n-1} \sum\limits_{i=1}^n (X_i - \bar{X})^2}$$

如果不是除以 $n-1$ 而是除以 $n$，这样得到的方差估计是**有偏样本方差**。这样算出来的有偏估计 $s_{\text{biased}}^2$ 满足 $\mathbb E[s_{\text{biased}}^2] = \frac{n-1}{n} \sigma^2$。TODO: 不知道有什么用。

## 协方差

TODO:

$$r = \frac {\widehat{\text{Cov}}(X,Y)} {(n-1) \widehat{\text{SD}}(X) \widehat{\text{SD}}(Y)}$$

