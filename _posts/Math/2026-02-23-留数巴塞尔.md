---
title: '留数巴塞尔'
date: 2026-02-23
permalink: /posts/2026/02/2026-02-23-留数巴塞尔/
excerpt: "$\frac {\pi^2} 6$？！"
tags:
  - Math
---

> 对于 $a > 0$，计算这个级数：
>
> $$\sum_{n=-\infty}^\infty \frac 1 {n^2 + a^2}$$
>
> 并求解 Basel 问题：
>
> $$\sum_{n=1}^\infty \frac 1 {n^2} = \lim_{a \to 0} \sum_{n=1}^\infty \frac 1 {n^2 + a^2}$$

我们考虑使用留数定理。我们构造一个复变函数，使得我们要求和的项恰好为极点处的留数。

先找一个函数使得每个整数都是它的极点。我们发现 $\cot(\pi z)$ 是一个不错的选择，并计算它的留数：

$$\text{Res}_{z = n} \cot(\pi z) = \frac 1 \pi$$

稍微改改就能用了：

$$\text{Res}_{z = n} \frac {\pi \cot(\pi z)} {z^2 + a^2} = \frac 1 {n^2 + a^2}$$

$$\boxed{
    f(z) = \frac {\pi \cot(\pi z)} {z^2 + a^2}
}$$

当然，还要注意这个函数多了两个极点 $\pm ia$，要记得减掉：

$$\begin{aligned}
    & \sum_{n=-\infty}^\infty \frac 1 {n^2 + a^2} \\
    =& \sum_{n=-\infty}^\infty \text{Res}_{z = n} f(z) \\
    =& \lim_{N \to \infty} \frac 1 {2 \pi i} \oint_{C_N} f(z) dz - \left( \text{Res}_{z = ia} f(z) + \text{Res}_{z = -ia} f(z) \right) \\
\end{aligned}$$

取一条离实轴比较远的围道。在离实轴比较远处，$\cot(\pi z)$ 是有界的。但是 $z^2 + a^2$ 在涨，因此它们的比值的积分 $\oint f(z) dz$ 趋于 $0$。

两个留数好算：

$$\begin{aligned}
    & \text{Res}_{z = ia} f(z) \\
    =& \frac {\pi \cot(\pi z)} {(z^2 + a^2)'} \vert_{z=\pm ia} \\
    =& \frac {\pi \cot (\pm \pi i a)} {\pm 2 i a} \\
    =& - \frac \pi {2a} \coth(\pi a)
\end{aligned}$$

得到：

$$\boxed{
    \sum_{n=-\infty}^\infty \frac 1 {n^2 + a^2} = \frac \pi a \coth(\pi a)
}$$

如果只留正的 $n$：

$$\boxed{
    \sum_{n=1}^\infty \frac 1 {n^2 + a^2} = \frac \pi {2a} \coth(\pi a) - \frac 1 {2a^2}
}$$

然后再求 Basel 问题，取极限 $a \to 0$：

$$x \coth x = 1 + \frac {x^2} 3 + O(x^4)$$

$$\begin{aligned}
    & \lim_{a \to 0} \left( \frac \pi {2a} \coth(\pi a) - \frac 1 {2a^2} \right) \\
    =& \lim_{a \to 0} \frac {\pi a \coth(\pi a) - 1} {2 a^2} \\
    =& \lim_{a \to 0} \frac {\frac {\pi^2} 3 a^2 + O(a^4)} {2 a^2} \\
    =& \frac {\pi^2} 6
\end{aligned}$$

$$\boxed{
    \sum_{n=1}^\infty \frac 1 {n^2} = \frac {\pi^2} 6
}$$