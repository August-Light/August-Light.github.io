---
title: '双曲函数'
date: 2026-01-16
permalink: /posts/2026/01/2026-01-16-双曲函数/
excerpt: "Lorentz Boost 也是旋转！"
tags:
  - Math
---

# 写在前面

TODO:

## 前置知识

### $\int \frac 1 {\sqrt{1 + x^2}} dx$ 的计算

$$\begin{aligned}
    & \int \frac 1 {\sqrt{1 + x^2}} dx \\
    =& \int \frac 1 {\sqrt{1 + \tan^2 \theta}} \sec^2 \theta d\theta & x = \tan \theta \\
    =& \int \sec\theta d\theta \\
    =& \ln \lvert \tan \theta + \sec \theta\rvert + C \\
    =& \ln \lvert x + \sqrt{1 + x^2} \rvert + C \\
    =& \ln \left( x + \sqrt{1 + x^2} \right) + C \\
\end{aligned}$$

绝对值内恒正可以这么说明：$\sqrt{x^2 + 1} > \lvert x \rvert$，而 $x + \lvert x \rvert \ge 0$。

这里埋两个伏笔：
- 有的人第一眼拿到这个题时可能会不小心看成 $\int \frac 1 {\sqrt{1 - x^2}} dx$ 然后直接积出 $\arcsin x$。但是这两个题真的没关系吗？
- 为啥 $x + \sqrt{1 + x^2}$ 是恒正的，有没有更好的解释？

### 已知环路计算内部面积

$$\boxed{
    A = \frac 1 2 \oint (x dy - y dx)
}$$

理解 1：这个式子还可以写为

$$\frac 1 2 \oint \det \begin{bmatrix}
    x & y \\
    dx & dy
\end{bmatrix}$$

理解 2：考虑根据 Green 公式进行构造

$$\oint_C (P dx + Q dy) = \iint_D \left( \frac {\partial Q} {\partial x} - \frac {\partial P} {\partial y} \right) dA$$

若构造 $P,Q$ 使得

$$\frac {\partial Q} {\partial x} - \frac {\partial P} {\partial y} \equiv 1$$

则 $\oint (P dx + Q dy)$ 就会给出面积。$P = - \frac y 2, Q = \frac x 2$ 就是一个合理的构造。

# 悬链线

> 挂在空中的呈 U 形的不可拉伸绳子，形成的形状是？

这个形状称为**悬链线 (catenary)**。Galileo 在这个问题上曾经犯过错误，他错误地认为这玩意儿是一个抛物线。

推导过程及本部分图片来源为[该视频](https://www.bilibili.com/video/BV17WuRzZEqB/)。

从悬链线底部取一小段作受力分析：

<img src=https://cdn.luogu.com.cn/upload/image_hosting/angwo4xa.png width=400>

$$\begin{cases}
    F_T \sin \theta = mg = \frac {g M} L l \\
    F_T \cos \theta = F \\
\end{cases}$$

$$\tan \theta = \frac {g M} {F L} l$$

$\frac {g M} {F L}$ 是常数，用 $k$ 代替：

$$\tan \theta = k l$$

$\tan \theta$ 是斜率，显然就是 $y'$；$l$ 可以对微小弧长积分 $l = \int_0^x \sqrt{1 + (y')^2} dx$ 得到：

$$\begin{aligned}
    y' &= k \int_0^x \sqrt{1 + (y')^2} dx \\
    y'' &= k \sqrt{1 + (y')^2} \\
    \frac 1 {\sqrt{1 + (y')^2}} y'' &= k \\
    \int \frac 1 {\sqrt{1 + (y')^2}} y'' dx &= kx + C \\
    \int \frac 1 {\sqrt{1 + (y')^2}} d(y') &= kx + C \\
    \ln (y' + \sqrt{1 + (y')^2}) &= kx + C & C = 0 \\
    y' &= \frac {e^{kx} - e^{-kx}} 2 \\
    y &= \frac 1 k \frac {e^{kx} + e^{-kx}} 2 \\
\end{aligned}$$

# $\cosh$

我们着重研究答案中的这个形式：

$$y = \frac {e^x + e^{-x}} 2$$

联想到 $\cos$ 的 $\exp$ 形式：

$$\cos x = \frac {e^{ix} + e^{-ix}} 2$$

不难发现

$$y = \cos(ix)$$

$\cos(ix)$ 看起来也太不像一个正经的实函数了，给它重新起个名字：

$$\boxed{
    \cosh x := \cos(ix) = \frac {e^x + e^{-x}} 2
}$$

悬链线方程可以重新写成：

$$y = \frac 1 k \cosh(k x)$$

## Galileo 真的错了吗？

Galileo 觉得这玩意儿长得像抛物线，真的没有道理吗？

$$\cosh x = \sum_{n=0}^\infty \frac {x^{2n}} {(2n)!} = 1 + \frac {x^2} 2 + O(x^4)$$

好吧，长得确实像抛物线。

# $\sinh$

考虑一下 $\cosh$ 的导数：

$$\cosh' x = \frac {e^x - e^{-x}} 2$$

$$\cosh'' x = \frac {e^x + e^{-x}} 2 = \cosh x$$

这也太像 $\sin$ 和 $\cos$ 了，很难忍住不下这么个定义：

$$\boxed{
    \sinh x := \frac {e^x - e^{-x}} 2
}$$

根据 $\sin x = \frac {e^{ix} - e^{-ix}} 2$ 又能得到：

$$\boxed{
    \sinh x = - i \sin(ix)
}$$

进一步地，还可以定义 $\tan$ 和其他三角函数的类比：

$$\tanh x := \frac {\sinh x} {\cosh x}$$

# 双曲函数的性质

求导关系：

$$\begin{cases}
    \sinh' x = \cosh x \\
    \cosh' x = \sinh x \\
\end{cases}$$

与三角函数的关系：

$$\begin{cases}
    \cosh x = \cos(ix) \\
    \sinh x = - i \sin(ix) \\
\end{cases}$$

$$\begin{cases}
    \cos x = \cosh(ix) \\
    \sin x = - i \sinh(ix)  \\
\end{cases}$$

利用这组关系，可以把每个三角恒等式都移植出一个双曲函数的版本。

Euler 公式 $\cos x + i \sin x = e^{ix}$ 的类比：

$$\begin{cases}
    \cosh x + \sinh x = e^x \\
    \cosh x - \sinh x = e^{-x} \\
\end{cases}$$

$\cosh$ 的弧长性质（悬链线上斜率与弧长成正比）：

$$\int_0^x \sqrt{1 + \cosh'(t)^2} dt = \sinh x$$

对两边求导，可以得到 $\sin^2 x + \cos^2 x = 1$ 的类比：

$$\sqrt{1 + \sinh(x)^2} = \cosh x$$

$$\boxed{
    \cosh^2 x - \sinh^2 x = 1
}$$

## 单位双曲线

单位圆 $x^2 + y^2 = 1$ 可以用三角函数的参数方程表示：

$$\begin{cases}
    x = \cos \theta \\
    y = \sin \theta \\
\end{cases}$$

类比地，用双曲函数构造参数方程

$$\begin{cases}
    x = \cosh \phi \\
    y = \sinh \phi \\
\end{cases}$$

可以得到**单位双曲线**（只有右支，因为 $\cosh$ 恒正）：

$$\boxed{
    x^2 - y^2 = 1
}$$

这也是 $\sinh$ 和 $\cosh$ 被称为**双曲函数**的原因。此处 $\phi$ 被称为**双曲角**。三角函数为了和双曲函数形成对比，也被称为**圆函数**。

$\phi$ 可以被 $x,y$ 简单地表示：

$$\begin{aligned}
    x + y &= e^\phi \\
    \phi &= \ln(x + y) \\
\end{aligned}$$

> 开头的问题：优雅地证明 $x + \sqrt{1 + x^2}$ 恒正。

换元 $x = \sinh \phi$，原式为 $\sinh \phi + \cosh \phi = e^\phi > 0$。

## 双曲角 $\phi$ 的几何意义

$(\cos \theta, \sin \theta)$ 构成的扇形，面积 $A$ 为 $\frac \theta 2$。

$(\cosh \phi, \sinh \phi)$ 构成的“扇形”，面积 $A$ 也为 $\frac \phi 2$：

<img src=https://cdn.luogu.com.cn/upload/image_hosting/1svwqm2k.png width=400>

经过原点的直线上的积分对面积没有贡献为 $0$，因此只考虑双曲线上的积分：

$$\begin{aligned}
    A(\phi) &= \frac 1 2 \int (x dy - y dx) \\
    &= \frac 1 2 \int_0^\phi (\cosh^2 t - \sinh^2 t) dt \\
    &= \frac \phi 2 \\
\end{aligned}$$

# 反双曲函数

## $\operatorname{arsinh}$

定义 $\operatorname{arsinh}$ 为 $\sinh$ 的反函数。

> 关于名字：
> - 反三角函数中的 $\text{arc}$ 指的是弧长，因为角可以看成单位圆上的弧长；
> - 但是反双曲函数的 $\text{ar}$ 指的是面积 area，因为双曲角丢失了弧长的含义，只有面积的几何意义。
> - Fun fact：然而确实有 $\operatorname{arcsinh}$ 的写法。
>   - 守序善良：Geogebra 两者都支持。
>   - 混乱善良：Mathematica 只支持 arcsinh 不支持 arsinh。
>   - 混乱邪恶：Markdown 两者都不支持。

我们尝试求出其解析式。设 $\phi = \operatorname{arsinh} y$。

$$\begin{aligned}
    & \phi \\
    =& \ln(x + y) \\
    =& \ln(\sqrt{1 + y^2} + y) \\
\end{aligned}$$

$$\boxed{
    \operatorname{arsinh} x = \ln \left( x + \sqrt{1 + x^2} \right)
}$$

> 利用双曲换元，再次计算积分 $\int \frac 1 {\sqrt{1 + x^2}} dx$。

$$\begin{aligned}
    & \int \frac 1 {\sqrt{1 + x^2}} dx \\
    =& \int \frac 1 {\sqrt{1 + \sinh^2 t}} \cosh t dt & x = \sinh t \\
    =& \int \frac {\cosh t} {\cosh t} dt \\
    =& t + C \\
    =& \operatorname{arsinh} x + C
\end{aligned}$$

类比 $\int \frac 1 {\sqrt{1 - x^2}} dx = \arcsin x + C$，这看起来是不是好多了？

## $\operatorname{arcosh}$

定义 $\operatorname{arcosh} x$ 为满足 $\cosh t = x$ 的唯一非负实数 $t$。

经过一样的推导可以得到：

$$\boxed{
    \operatorname{arcosh} x = \ln \left( x + \sqrt{x^2 - 1} \right)
}$$

## 快度（狭义相对论）

$$\begin{cases}
    \cosh \phi = \gamma \\
    \sinh \phi = \gamma \beta \\
\end{cases}$$

TODO:

$$\operatorname{artanh} \frac v c = \operatorname{artanh} \frac {v_1} c + \operatorname{artanh} \frac {v_2} c$$

作 Taylor 展开：

$$\operatorname{artanh} x = \sum_{n=0}^\infty \frac {x^{2n+1}} {2n+1} = x + O(x^3)$$

在 $\frac v c \ll 1$ 时：

$$\operatorname{artanh} \frac v c \approx \frac v c$$

$$v \approx v_1 + v_2$$

因此我们在日常生活中才会觉得时空在不同参考系的转换是 Galileo 变换。~~Galileo 怎么又是你~~？