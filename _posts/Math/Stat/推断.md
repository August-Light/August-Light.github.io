# 置信区间

我们有一个随机变量的样本，其一个统计量为 $\hat\theta$。

我们可以构造一个**置信水平**为 $1 - \alpha$ 的**置信区间** $[l,r]$。我们说，我们有 $1 - \alpha$ 的**信心**，真实值 $\theta \in [l,r]$。

**信心**是什么意思？指的是，我们多次重复这个实验，长期来看有 $1 - \alpha$ 的覆盖成功率。

我们一般用以下格式描述置信区间：

$$\text{estimate} \pm \text{margin of error}$$

众所周知，统计学还很喜欢用标准差来描述东西。我们也会把 $\text{margin of error}$ 用标准差的几倍来描述。

但是很遗憾，$\text{SD}(\theta)$ 的确切值也是未知的。因此我们只能使用估计的标准差 $\widehat{\text{SD}}(\theta)$，称为**标准误**，记作 $\text{SE}(\hat\theta)$。

因此置信区间也可以这样描述：

$$\hat\mu \pm k^* \times \text{SE}(\hat\theta)$$

其中 $k^*$ 是一个不带量纲的系数。

## 常见错误

- 真实 $\theta$ 有 $1 - \alpha$ 的概率落在置信区间 $[l,r]$ 内？
  - 真实 $\theta$ **不是随机变量**，置信区间也**不是随机变量**，根本没有概率这一说，要说也就只有 $0$ 或 $1$。这个值是确定的，只是我们不知道。
  - 我们只能说，我们有 $1 - \alpha$ 的**信心**认为，$\theta \in [l,r]$。
- 对于这次算出来的 $[l,r]$，我以后重复好多次实验，$\hat\theta$ 有 $1 - \alpha$ 的概率落在 $[l,r]$ 内？
  - $[l,r]$ 只是基于这个样本算出来的，和其他样本没有关系。

## 常用 $\text{SE}$ 计算

TODO: 为啥是有偏估计？

$$\text{SE}(\bar x) = \frac s {\sqrt n}$$

$$\text{SE}(\hat p) = \sqrt{\frac {\hat p (1 - \hat p)} n}$$

## 例子

> Example 6.8 美国疾病控制与预防中心 (CDC) 的一名调查员想要了解所有成年人中已完全接种新冠疫苗并接种加强针的比例。如果要求结果在 $96\%$ 的置信水平下误差不超过 $\pm 0.03$，那么应该选择多少名成年人作为样本？
>
> - 假设每个人是否接种疫苗相互独立。
> - 假设该二项分布足够大，可以看作正态分布。

我们可以计算出 $z^*$：

$z^* = \text{invNorm}(\frac {1 - 96\%} 2) \approx -2.05$

也就是说 $2.05 \times \text{SE}(\hat p) \le 0.03$。

$$\frac {\sqrt{\hat p (1 - \hat p)}} {\sqrt n} \le \frac {0.03} {2.05}$$

分子是 $\le \frac 1 2$ 的，我们只需要保证分子最大的时候也依然满足限制：

$$\frac 1 {2 \sqrt n} \le \frac {0.03} {2.05}$$

解得 $n \ge 1171.63$（带入了 $z^*$ 的精确值）。书上由于只保留了两位小数所以最后一步算出来 $1167.4$。最终答案要向上取整。

# 显著性

一般来说，对于一个问题，我们会有两种立场。比如，对于一种药的药效，可能一方会说药有效，一方会说药无效。

一般来说，对于“无效”的这一方，我们称他们的立场为**零假设** $H_0$。另一方称为**备择假设** $H_a$。

比如说，我有一个总体参数 $\theta$，我想知道它和我希望的 $\theta_0$ 是否相等。我可以说：
- $H_0$：$\theta = \theta_0$，确实相等。
- $H_a$：$\theta \ne \theta_0$，有显著差距。

我们会计算一个 p 值 $p$，表示**当 $H_0$ 为真的前提下，出现更离谱结果的概率**。然后我们再设定一个**显著性水平** $\alpha$，如果离谱水平 $p < \alpha$，说明出现更离谱结果概率很小，即手上的结果已经很离谱了，则我们觉得 $H_0$ 是错的，拒绝 $H_0$，接受 $H_a$。

注意一个用词：对于 $H_0$，我们不说接受，我们只说有没有足够证据拒绝它。

当然你会说，这是个概率问题，肯定有误判的时候。针对不同种类的误判，我们起了不同名字：

|  | $H_0$ 确实是真的 | $H_0$ 其实是错的 |
| - | - | - |
| 我觉得 $H_0$ 是错的（拒绝 $H_0$） | **Type I Error** | Correct decision |
| 我觉得 $H_0$ 是对的（不拒绝 $H_0$） | Correct decision | **Type II Error** |