我们研究 $k$ 维的标准正态分布。

我们从这个分布中取一个值 $\vec{x}$，注意到正态分布有着**各向同性**的性质，因此我们想研究 $\lVert \vec{x} \rVert$。更确切地说，我们想研究 $\lVert \vec{x} \rVert^2$ 的 PDF（这个值可以直接表示为坐标平方和而不用开根号，肯定比直接算 $\lVert \vec{x} \rVert$ 要更好算）。

这个概率分布记作 $\chi^2(k)$，称为**卡方分布**。

# 计算

## $\chi^2(1)$ 的计算

令 $f$ 为 $\chi^2(1)$ 的 PDF，$f_N$ 为标准正态分布 $\mathcal N(0,1)$ 的 PDF。

考虑从 CDF 的角度考虑，然后求导得到 PDF 表达式。

令 $\varphi(x) = \int_0^x f_N(t) dt$，注意 $\varphi' = f_N$。

$$\int_0^x f(t) dt = \int_{- \sqrt x}^{\sqrt x} f_N(t) dt = 2 \varphi(\sqrt x)$$

两侧同时求导：

$$f(x) = \frac 1 {2 \sqrt x} \times 2 f_N(\sqrt x) = \frac 1 {\sqrt x} f_N(\sqrt x)$$

最终得到：

$$f(x) = \frac 1 {\sqrt {2 \pi x}} e^{- \frac x 2}$$

## $\chi^2(k)$ 的计算

有一种比较直接的计算方法是把 $k$ 个 $\chi^2(1)$ 卷起来，当中涉及到的积分是 Beta 函数，一堆 Beta 函数的连乘在化为 Gamma 函数之后可以抵消。但是这么做并不优雅，因为我们忽略了**各向同性**的本质。

考虑几何意义的本质

TODO:

$$f_N(\vec{x}) = \frac 1 {(2 \pi)^{\frac k 2}} \exp (- \frac 1 2 \lVert x \rVert^2)$$

$$F(x) = \int_{\lVert \vec{r} \rVert \le x} \exp(- \frac 1 2 \lVert \vec{r} \rVert^2) dV$$

$$F(x) = $$

$$f(x) = \frac 1 {2^{\frac k 2} \Gamma(\frac k 2)} x^{\frac k 2 - 1} e^{- \frac x 2}$$

定义域 $x > 0$。

注意对于正整数 $k$，$\Gamma(\frac k 2)$ 是可以写开的。

