# 树上 DP

## [P2014 [CTSC1997] 选课](https://www.luogu.com.cn/problem/P2014)

> 
>
> TODO:

$O(nm)$

https://www.luogu.com.cn/article/v8s8o0ft

## [P3237 [HNOI2014] 米特运输](https://www.luogu.com.cn/problem/P3237) (Medium)

>

注意到确定一个权值之后整棵树权值固定。

## [P3523 [POI 2011] DYN-Dynamite](https://www.luogu.com.cn/problem/P3523) (Hard)



只有不得不选才选，否则可以选父亲更优

https://www.luogu.com.cn/discuss/852114

## [P3596 [POI 2015] MOD](https://www.luogu.com.cn/problem/P3596)

类似：[AT_dp_v Subtree](https://www.luogu.com.cn/problem/AT_dp_v)

>

TODO:

# 状压 DP

## [P3977 [TJOI2015] 棋盘](https://www.luogu.com.cn/problem/P3977) (Easy)

TODO: 题意明确

矩阵快速幂经常和状压一起

## [P3160 [CQOI2012] 局部极小值](https://www.luogu.com.cn/problem/P3160)

TODO: 题意明确

注意到极小值只能最多有 $8$ 个。

容斥经常和状压一起

## [P3226 [HNOI2012] 集合选数](https://www.luogu.com.cn/problem/P3226) (Medium)

TODO:

# 数位 DP

## [P3107 [USACO14OPEN] Odometer S](https://www.luogu.com.cn/problem/P3107)

TODO:

## [P9129 [USACO23FEB] Piling Papers G](https://www.luogu.com.cn/problem/P9129)



TODO:

# 动态 DP

## [[ABC246Ex] 01? Queries](https://www.luogu.com.cn/problem/AT_abc246_h)

TODO:

# 有后效性 DP

当 DP 式子有后效性怎么办？

- 高斯消元即可。
- 若系数矩阵有特殊性质，则可能有低于立方的做法。

## [P3232 [HNOI2013] 游走](https://www.luogu.com.cn/problem/P3232) (Easy)

> 给定一个无向连通图，边有边权，且 $m$ 条边的边权是一个 $[1,m]$ 的排列（但是你不知道具体怎么排）。初始时你在 $1$ 号节点，每次等概率走到一个相邻节点，到达 $n$ 号节点结束。找到一个方案使得走过的期望长度最小，输出这个期望长度。
>
> $n \le 500$，$m \le 1.25 \times 10^5$。

问题转化为求经过每条边的期望次数，期望次数越大赋越小的值（排序不等式）。图上随机游走求期望，直接考虑高斯消元。

设 $f_{(u,v)}$ 表示走过 $u \leftrightarrow v$ 这条边的次数。但是直接对 $\mathbb E[f_{(u,v)}]$ 高斯消元肯定是 TLE 的，我们把边走过的期望次数转化为点的期望次数：

$$\mathbb E[f_{(u,v)}] = \frac {\mathbb E[f_u]} {\text{deg}_u} + \frac {\mathbb E[f_v]} {\text{deg}_v}$$

其中 $f_u$ 表示经过 $u$ 的次数。

而 $\mathbb E[f_u]$ 是好算的：

$$\mathbb E[f_u] = \begin{cases}
    \sum\limits_{v \ne n} \frac {\mathbb E[f_v]} {\text{deg}_v} & u \not \in \{1,n\} \\
    1 + \sum\limits_{v \ne n} \frac {\mathbb E[f_v]} {\text{deg}_v} & u = 1
\end{cases}$$

高斯消元即可。时间复杂度 $O(n^3)$。

## [CF24D Broken robot](https://www.luogu.com.cn/problem/CF24D) (Medium)

> 有一个左上角 $(1,1)$ 到右下角 $(n,m)$ 的网格。一个机器人初始位于 $(x,y)$，不能走出网格。机器人每步可以往左、右、下走一步或原地不动。机器人每步从合法的操作中等概率选择一个操作。求走到最下面一行的期望步数。
>
> $n,m \le 10^3$。

类似题目：[P7099 [yLOI2020] 灼](https://www.luogu.com.cn/problem/P7099)

先特判掉 $m=1$ 的情况，答案是 $2 (n-x)$。

设 $f_{i,j}$ 是 $(i,j)$ 走到最后一行的期望步数。

我们注意到行内的状态会互相影响，但是行间不会。我们设 $f_{i+1,j}$ 是下一行的状态，现在我们要反推上一行 $f_{i,j}$。

对于 $j \not \in \{1,m\}$：

$$f_{i,j} = \frac 1 4 (f_{i,j} + f_{i,j-1} + f_{i,j+1} + f_{i+1,j}) + 1$$

边缘：

$$f_{i,1} = \frac 1 3 (f_{i,1} + f_{i,2} + f_{i+1,1}) + 1$$

$$f_{i,m} = \frac 1 3 (f_{i,m} + f_{i,m-1} + f_{i+1,m}) + 1$$

先来看第一个式子，后两个同理。第一个式子可以变形成这样：

$$3 f_{i,j} - f_{i,j-1} - f_{i,j+1} = 4 + f_{i+1,j}$$

后两个：

$$2 f_{i,1} - f_{i,2} = 3 + f_{i+1,1}$$

$$2 f_{i,m} - f_{i,m-1} = 3 + f_{i+1,m}$$

最后的系数矩阵长这样：

$$\begin{bmatrix}
    2 & -1 & \\
    -1 & 3 & -1 \\
    & -1 & 3 & -1 \\
    & & \ddots \\
    & & -1 & 3 & -1 \\
    & & & -1 & 2 \\
\end{bmatrix}$$

是非常稀疏的三对角矩阵，因此根本用不着高斯消元法，直接硬消就是 $O(m)$ 的。~~这种 trivial 的东西甚至有个 [Wiki 词条](https://zh.wikipedia.org/wiki/%E4%B8%89%E5%AF%B9%E8%A7%92%E7%9F%A9%E9%98%B5%E7%AE%97%E6%B3%95)~~

总时间复杂度 $O(nm)$。