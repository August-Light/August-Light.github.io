> 有 $n$ 个点，每个点 $u$ 有 $a_u$ 的权值。每个点有 $0$ 或 $1$ 个父亲，只有拿了父亲才能拿这个点。求选择 $m$ 个点的最大权值和。

首先先把没有父亲的点都连到一个根 $0$ 上，这样就把森林问题转化为树问题。

设 $f_{u,i}$ 为点 $u$ 的子树内背包大小为 $i$ 的答案。最终答案即为 $f_{0,m}$。

很容易写出状态转移方程：

```cpp
    siz[u] = 1;
    f[u][1] = a[u];
    for (auto v : G[u]) {
        dfs(v);
        per(i, min(siz[u], m), 1)
            rep(j, 1, min(siz[v], m-i))
                cmax(f[u][i+j], f[u][i] + f[v][j]);
        siz[u] += siz[v];
    }
```

可以证明，这个写法的时间复杂度是 $O(nm)$ 的。